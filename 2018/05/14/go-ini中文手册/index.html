<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="简体中文">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="golang,go," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="本包提供了 Go 语言中读写 INI 文件的功能。 功能特性 支持覆盖加载多个数据源（[]byte、文件和 io.ReadCloser） 支持递归读取键值 支持读取父子分区 支持读取自增键名 支持读取多行的键值 支持大量辅助方法 支持在读取时直接转换为 Go 语言类型 支持读取和 写入 分区和键的注释 轻松操作分区、键值和注释 在保存文件时分区和键值会保持原有的顺序  下载安装使用一个特定版本：">
<meta name="keywords" content="golang,go">
<meta property="og:type" content="article">
<meta property="og:title" content="go-ini手册">
<meta property="og:url" content="https://zhanghongtong.github.io/2018/05/14/go-ini中文手册/index.html">
<meta property="og:site_name" content="张奇怪的blog">
<meta property="og:description" content="本包提供了 Go 语言中读写 INI 文件的功能。 功能特性 支持覆盖加载多个数据源（[]byte、文件和 io.ReadCloser） 支持递归读取键值 支持读取父子分区 支持读取自增键名 支持读取多行的键值 支持大量辅助方法 支持在读取时直接转换为 Go 语言类型 支持读取和 写入 分区和键的注释 轻松操作分区、键值和注释 在保存文件时分区和键值会保持原有的顺序  下载安装使用一个特定版本：">
<meta property="og:locale" content="简体中文">
<meta property="og:updated_time" content="2018-05-14T07:27:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="go-ini手册">
<meta name="twitter:description" content="本包提供了 Go 语言中读写 INI 文件的功能。 功能特性 支持覆盖加载多个数据源（[]byte、文件和 io.ReadCloser） 支持递归读取键值 支持读取父子分区 支持读取自增键名 支持读取多行的键值 支持大量辅助方法 支持在读取时直接转换为 Go 语言类型 支持读取和 写入 分区和键的注释 轻松操作分区、键值和注释 在保存文件时分区和键值会保持原有的顺序  下载安装使用一个特定版本：">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zhanghongtong.github.io/2018/05/14/go-ini中文手册/"/>





  <title>go-ini手册 | 张奇怪的blog</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="简体中文">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">张奇怪的blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhanghongtong.github.io/2018/05/14/go-ini中文手册/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张奇怪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张奇怪的blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">go-ini手册</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-14T14:55:12+08:00">
                2018-05-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/golang/" itemprop="url" rel="index">
                    <span itemprop="name">golang</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本包提供了 Go 语言中读写 INI 文件的功能。</p>
<h2 id="功能特性"><a href="#功能特性" class="headerlink" title="功能特性"></a>功能特性</h2><ul>
<li>支持覆盖加载多个数据源（<code>[]byte</code>、文件和 <code>io.ReadCloser</code>）</li>
<li>支持递归读取键值</li>
<li>支持读取父子分区</li>
<li>支持读取自增键名</li>
<li>支持读取多行的键值</li>
<li>支持大量辅助方法</li>
<li>支持在读取时直接转换为 Go 语言类型</li>
<li>支持读取和 <strong>写入</strong> 分区和键的注释</li>
<li>轻松操作分区、键值和注释</li>
<li>在保存文件时分区和键值会保持原有的顺序</li>
</ul>
<h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p>使用一个特定版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get gopkg.in/ini.v1</span><br></pre></td></tr></table></figure>
<p>使用最新版：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get github.com/go-ini/ini</span><br></pre></td></tr></table></figure>
<p>如需更新请添加 <code>-u</code> 选项。</p>
<h3 id="测试安装"><a href="#测试安装" class="headerlink" title="测试安装"></a>测试安装</h3><p>如果您想要在自己的机器上运行测试，请使用 <code>-t</code> 标记：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get -t gopkg.in/ini.v1</span><br></pre></td></tr></table></figure>
<p>如需更新请添加 <code>-u</code> 选项。</p>
<h2 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h2><h3 id="从数据源加载"><a href="#从数据源加载" class="headerlink" title="从数据源加载"></a>从数据源加载</h3><p>一个 <strong>数据源</strong> 可以是 <code>[]byte</code> 类型的原始数据，<code>string</code> 类型的文件路径或 <code>io.ReadCloser</code>。您可以加载 <strong>任意多个</strong> 数据源。如果您传递其它类型的数据源，则会直接返回错误。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfg, err := ini.Load([]<span class="keyword">byte</span>(<span class="string">"raw data"</span>), <span class="string">"filename"</span>, ioutil.NopCloser(bytes.NewReader([]<span class="keyword">byte</span>(<span class="string">"some other data"</span>))))</span><br></pre></td></tr></table></figure>
<p>或者从一个空白的文件开始：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfg := ini.Empty()</span><br></pre></td></tr></table></figure>
<p>当您在一开始无法决定需要加载哪些数据源时，仍可以使用 <strong>Append()</strong> 在需要的时候加载它们。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">err := cfg.Append(<span class="string">"other file"</span>, []<span class="keyword">byte</span>(<span class="string">"other raw data"</span>))</span><br></pre></td></tr></table></figure>
<p>当您想要加载一系列文件，但是不能够确定其中哪些文件是不存在的，可以通过调用函数 <code>LooseLoad</code> 来忽略它们（<code>Load</code> 会因为文件不存在而返回错误）：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfg, err := ini.LooseLoad(<span class="string">"filename"</span>, <span class="string">"filename_404"</span>)</span><br></pre></td></tr></table></figure>
<p>更牛逼的是，当那些之前不存在的文件在重新调用 <code>Reload</code> 方法的时候突然出现了，那么它们会被正常加载。</p>
<h4 id="忽略键名的大小写"><a href="#忽略键名的大小写" class="headerlink" title="忽略键名的大小写"></a>忽略键名的大小写</h4><p>有时候分区和键的名称大小写混合非常烦人，这个时候就可以通过 <code>InsensitiveLoad</code> 将所有分区和键名在读取里强制转换为小写：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cfg, err := ini.InsensitiveLoad(<span class="string">"filename"</span>)</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// sec1 和 sec2 指向同一个分区对象</span></span><br><span class="line">sec1, err := cfg.GetSection(<span class="string">"Section"</span>)</span><br><span class="line">sec2, err := cfg.GetSection(<span class="string">"SecTIOn"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// key1 和 key2 指向同一个键对象</span></span><br><span class="line">key1, err := sec1.GetKey(<span class="string">"Key"</span>)</span><br><span class="line">key2, err := sec2.GetKey(<span class="string">"KeY"</span>)</span><br></pre></td></tr></table></figure>
<h4 id="类似-MySQL-配置中的布尔值键"><a href="#类似-MySQL-配置中的布尔值键" class="headerlink" title="类似 MySQL 配置中的布尔值键"></a>类似 MySQL 配置中的布尔值键</h4><p>MySQL 的配置文件中会出现没有具体值的布尔类型的键：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line">...</span><br><span class="line">skip-host-cache</span><br><span class="line">skip-name-resolve</span><br></pre></td></tr></table></figure>
<p>默认情况下这被认为是缺失值而无法完成解析，但可以通过高级的加载选项对它们进行处理：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfg, err := ini.LoadSources(ini.LoadOptions&#123;AllowBooleanKeys: <span class="literal">true</span>&#125;, <span class="string">"my.cnf"</span>))</span><br></pre></td></tr></table></figure>
<p>这些键的值永远为 <code>true</code>，且在保存到文件时也只会输出键名。</p>
<p>如果您想要通过程序来生成此类键，则可以使用 <code>NewBooleanKey</code>：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key, err := sec.NewBooleanKey(<span class="string">"skip-host-cache"</span>)</span><br></pre></td></tr></table></figure>
<h4 id="关于注释"><a href="#关于注释" class="headerlink" title="关于注释"></a>关于注释</h4><p>下述几种情况的内容将被视为注释：</p>
<ol>
<li>所有以 <code>#</code> 或 <code>;</code> 开头的行</li>
<li>所有在 <code>#</code> 或 <code>;</code> 之后的内容</li>
<li>分区标签后的文字 (即 <code>[分区名]</code> 之后的内容)</li>
</ol>
<p>如果你希望使用包含 <code>#</code> 或 <code>;</code> 的值，请使用 <figure class="highlight plain"><figcaption><span>``` 或 ``` """ ``` 进行包覆。</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">除此之外，您还可以通过 `LoadOptions` 完全忽略行内注释：</span><br><span class="line"></span><br><span class="line">```go</span><br><span class="line">cfg, err := ini.LoadSources(ini.LoadOptions&#123;IgnoreInlineComment: true&#125;, &quot;app.ini&quot;))</span><br></pre></td></tr></table></figure></p>
<h3 id="操作分区（Section）"><a href="#操作分区（Section）" class="headerlink" title="操作分区（Section）"></a>操作分区（Section）</h3><p>获取指定分区：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">section, err := cfg.GetSection(<span class="string">"section name"</span>)</span><br></pre></td></tr></table></figure>
<p>如果您想要获取默认分区，则可以用空字符串代替分区名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">section, err := cfg.GetSection(<span class="string">""</span>)</span><br></pre></td></tr></table></figure>
<p>当您非常确定某个分区是存在的，可以使用以下简便方法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">section := cfg.Section(<span class="string">"section name"</span>)</span><br></pre></td></tr></table></figure>
<p>如果不小心判断错了，要获取的分区其实是不存在的，那会发生什么呢？没事的，它会自动创建并返回一个对应的分区对象给您。</p>
<p>创建一个分区：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">err := cfg.NewSection(<span class="string">"new section"</span>)</span><br></pre></td></tr></table></figure>
<p>获取所有分区对象或名称：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sections := cfg.Sections()</span><br><span class="line">names := cfg.SectionStrings()</span><br></pre></td></tr></table></figure>
<h3 id="操作键（Key）"><a href="#操作键（Key）" class="headerlink" title="操作键（Key）"></a>操作键（Key）</h3><p>获取某个分区下的键：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key, err := cfg.Section(<span class="string">""</span>).GetKey(<span class="string">"key name"</span>)</span><br></pre></td></tr></table></figure>
<p>和分区一样，您也可以直接获取键而忽略错误处理：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key := cfg.Section(<span class="string">""</span>).Key(<span class="string">"key name"</span>)</span><br></pre></td></tr></table></figure>
<p>判断某个键是否存在：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yes := cfg.Section(<span class="string">""</span>).HasKey(<span class="string">"key name"</span>)</span><br></pre></td></tr></table></figure>
<p>创建一个新的键：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">err := cfg.Section(<span class="string">""</span>).NewKey(<span class="string">"name"</span>, <span class="string">"value"</span>)</span><br></pre></td></tr></table></figure>
<p>获取分区下的所有键或键名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keys := cfg.Section(<span class="string">""</span>).Keys()</span><br><span class="line">names := cfg.Section(<span class="string">""</span>).KeyStrings()</span><br></pre></td></tr></table></figure>
<p>获取分区下的所有键值对的克隆：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hash := cfg.Section(<span class="string">""</span>).KeysHash()</span><br></pre></td></tr></table></figure>
<h3 id="操作键值（Value）"><a href="#操作键值（Value）" class="headerlink" title="操作键值（Value）"></a>操作键值（Value）</h3><p>获取一个类型为字符串（string）的值：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val := cfg.Section(<span class="string">""</span>).Key(<span class="string">"key name"</span>).String()</span><br></pre></td></tr></table></figure>
<p>获取值的同时通过自定义函数进行处理验证：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val := cfg.Section(<span class="string">""</span>).Key(<span class="string">"key name"</span>).Validate(<span class="function"><span class="keyword">func</span><span class="params">(in <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(in) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"default"</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> in</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果您不需要任何对值的自动转变功能（例如递归读取），可以直接获取原值（这种方式性能最佳）：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val := cfg.Section(<span class="string">""</span>).Key(<span class="string">"key name"</span>).Value()</span><br></pre></td></tr></table></figure>
<p>判断某个原值是否存在：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yes := cfg.Section(<span class="string">""</span>).HasValue(<span class="string">"test value"</span>)</span><br></pre></td></tr></table></figure>
<p>获取其它类型的值：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 布尔值的规则：</span></span><br><span class="line"><span class="comment">// true 当值为：1, t, T, TRUE, true, True, YES, yes, Yes, y, ON, on, On</span></span><br><span class="line"><span class="comment">// false 当值为：0, f, F, FALSE, false, False, NO, no, No, n, OFF, off, Off</span></span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"BOOL"</span>).Bool()</span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64"</span>).Float64()</span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT"</span>).Int()</span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64"</span>).Int64()</span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT"</span>).Uint()</span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64"</span>).Uint64()</span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).TimeFormat(time.RFC3339)</span><br><span class="line">v, err = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).Time() <span class="comment">// RFC3339</span></span><br><span class="line"></span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"BOOL"</span>).MustBool()</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64"</span>).MustFloat64()</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT"</span>).MustInt()</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64"</span>).MustInt64()</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT"</span>).MustUint()</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64"</span>).MustUint64()</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).MustTimeFormat(time.RFC3339)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).MustTime() <span class="comment">// RFC3339</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 由 Must 开头的方法名允许接收一个相同类型的参数来作为默认值，</span></span><br><span class="line"><span class="comment">// 当键不存在或者转换失败时，则会直接返回该默认值。</span></span><br><span class="line"><span class="comment">// 但是，MustString 方法必须传递一个默认值。</span></span><br><span class="line"></span><br><span class="line">v = cfg.Seciont(<span class="string">""</span>).Key(<span class="string">"String"</span>).MustString(<span class="string">"default"</span>)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"BOOL"</span>).MustBool(<span class="literal">true</span>)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64"</span>).MustFloat64(<span class="number">1.25</span>)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT"</span>).MustInt(<span class="number">10</span>)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64"</span>).MustInt64(<span class="number">99</span>)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT"</span>).MustUint(<span class="number">3</span>)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64"</span>).MustUint64(<span class="number">6</span>)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).MustTimeFormat(time.RFC3339, time.Now())</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).MustTime(time.Now()) <span class="comment">// RFC3339</span></span><br></pre></td></tr></table></figure>
<p>如果我的值有好多行怎么办？</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[advance]</span></span><br><span class="line"><span class="attr">ADDRESS</span> = <span class="string">"""404 road,</span></span><br><span class="line"><span class="string">NotFound, State, 5000</span></span><br><span class="line"><span class="string">Earth"""</span></span><br></pre></td></tr></table></figure>
<p>嗯哼？小 case！</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cfg.Section(<span class="string">"advance"</span>).Key(<span class="string">"ADDRESS"</span>).String()</span><br><span class="line"></span><br><span class="line"><span class="comment">/* --- start ---</span></span><br><span class="line"><span class="comment">404 road,</span></span><br><span class="line"><span class="comment">NotFound, State, 5000</span></span><br><span class="line"><span class="comment">Earth</span></span><br><span class="line"><span class="comment">------  end  --- */</span></span><br></pre></td></tr></table></figure>
<p>赞爆了！那要是我属于一行的内容写不下想要写到第二行怎么办？</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[advance]</span></span><br><span class="line"><span class="attr">two_lines</span> = how about \</span><br><span class="line">	continuation lines?</span><br><span class="line"><span class="attr">lots_of_lines</span> = <span class="number">1</span> \</span><br><span class="line">	2 \</span><br><span class="line">	3 \</span><br><span class="line">	4</span><br></pre></td></tr></table></figure>
<p>简直是小菜一碟！</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cfg.Section(<span class="string">"advance"</span>).Key(<span class="string">"two_lines"</span>).String() <span class="comment">// how about continuation lines?</span></span><br><span class="line">cfg.Section(<span class="string">"advance"</span>).Key(<span class="string">"lots_of_lines"</span>).String() <span class="comment">// 1 2 3 4</span></span><br></pre></td></tr></table></figure>
<p>可是我有时候觉得两行连在一起特别没劲，怎么才能不自动连接两行呢？</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cfg, err := ini.LoadSources(ini.LoadOptions&#123;</span><br><span class="line">	IgnoreContinuation: <span class="literal">true</span>,</span><br><span class="line">&#125;, <span class="string">"filename"</span>)</span><br></pre></td></tr></table></figure>
<p>哇靠给力啊！</p>
<p>需要注意的是，值两侧的单引号会被自动剔除：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">foo</span> = <span class="string">"some value"</span> // foo: some value</span><br><span class="line"><span class="attr">bar</span> = <span class="string">'some value'</span> // bar: some value</span><br></pre></td></tr></table></figure>
<p>有时您会获得像从 <a href="https://crowdin.com/" target="_blank" rel="noopener">Crowdin</a> 网站下载的文件那样具有特殊格式的值（值使用双引号括起来，内部的双引号被转义）：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">create_repo</span>=<span class="string">"创建了仓库 &lt;a href=\"%s\"&gt;%s&lt;/a&gt;"</span></span><br></pre></td></tr></table></figure>
<p>那么，怎么自动地将这类值进行处理呢？</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cfg, err := ini.LoadSources(ini.LoadOptions&#123;UnescapeValueDoubleQuotes: <span class="literal">true</span>&#125;, <span class="string">"en-US.ini"</span>))</span><br><span class="line">cfg.Section(<span class="string">"&lt;name of your section&gt;"</span>).Key(<span class="string">"create_repo"</span>).String() </span><br><span class="line"><span class="comment">// You got: 创建了仓库 &lt;a href="%s"&gt;%s&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>
<p>这就是全部了？哈哈，当然不是。</p>
<h4 id="操作键值的辅助方法"><a href="#操作键值的辅助方法" class="headerlink" title="操作键值的辅助方法"></a>操作键值的辅助方法</h4><p>获取键值时设定候选值：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"STRING"</span>).In(<span class="string">"default"</span>, []<span class="keyword">string</span>&#123;<span class="string">"str"</span>, <span class="string">"arr"</span>, <span class="string">"types"</span>&#125;)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64"</span>).InFloat64(<span class="number">1.1</span>, []<span class="keyword">float64</span>&#123;<span class="number">1.25</span>, <span class="number">2.5</span>, <span class="number">3.75</span>&#125;)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT"</span>).InInt(<span class="number">5</span>, []<span class="keyword">int</span>&#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64"</span>).InInt64(<span class="number">10</span>, []<span class="keyword">int64</span>&#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT"</span>).InUint(<span class="number">4</span>, []<span class="keyword">int</span>&#123;<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>&#125;)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64"</span>).InUint64(<span class="number">8</span>, []<span class="keyword">int64</span>&#123;<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>&#125;)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).InTimeFormat(time.RFC3339, time.Now(), []time.Time&#123;time1, time2, time3&#125;)</span><br><span class="line">v = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).InTime(time.Now(), []time.Time&#123;time1, time2, time3&#125;) <span class="comment">// RFC3339</span></span><br></pre></td></tr></table></figure>
<p>如果获取到的值不是候选值的任意一个，则会返回默认值，而默认值不需要是候选值中的一员。</p>
<p>验证获取的值是否在指定范围内：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64"</span>).RangeFloat64(<span class="number">0.0</span>, <span class="number">1.1</span>, <span class="number">2.2</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT"</span>).RangeInt(<span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64"</span>).RangeInt64(<span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT"</span>).RangeUint(<span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64"</span>).RangeUint64(<span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).RangeTimeFormat(time.RFC3339, time.Now(), minTime, maxTime)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIME"</span>).RangeTime(time.Now(), minTime, maxTime) <span class="comment">// RFC3339</span></span><br></pre></td></tr></table></figure>
<h5 id="自动分割键值到切片（slice）"><a href="#自动分割键值到切片（slice）" class="headerlink" title="自动分割键值到切片（slice）"></a>自动分割键值到切片（slice）</h5><p>当存在无效输入时，使用零值代替：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Input: 1.1, 2.2, 3.3, 4.4 -&gt; [1.1 2.2 3.3 4.4]</span></span><br><span class="line"><span class="comment">// Input: how, 2.2, are, you -&gt; [0.0 2.2 0.0 0.0]</span></span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"STRINGS"</span>).Strings(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64S"</span>).Float64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INTS"</span>).Ints(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64S"</span>).Int64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINTS"</span>).Uints(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64S"</span>).Uint64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIMES"</span>).Times(<span class="string">","</span>)</span><br></pre></td></tr></table></figure>
<p>从结果切片中剔除无效输入：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Input: 1.1, 2.2, 3.3, 4.4 -&gt; [1.1 2.2 3.3 4.4]</span></span><br><span class="line"><span class="comment">// Input: how, 2.2, are, you -&gt; [2.2]</span></span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64S"</span>).ValidFloat64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INTS"</span>).ValidInts(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64S"</span>).ValidInt64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINTS"</span>).ValidUints(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64S"</span>).ValidUint64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIMES"</span>).ValidTimes(<span class="string">","</span>)</span><br></pre></td></tr></table></figure>
<p>当存在无效输入时，直接返回错误：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Input: 1.1, 2.2, 3.3, 4.4 -&gt; [1.1 2.2 3.3 4.4]</span></span><br><span class="line"><span class="comment">// Input: how, 2.2, are, you -&gt; error</span></span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"FLOAT64S"</span>).StrictFloat64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INTS"</span>).StrictInts(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"INT64S"</span>).StrictInt64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINTS"</span>).StrictUints(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"UINT64S"</span>).StrictUint64s(<span class="string">","</span>)</span><br><span class="line">vals = cfg.Section(<span class="string">""</span>).Key(<span class="string">"TIMES"</span>).StrictTimes(<span class="string">","</span>)</span><br></pre></td></tr></table></figure>
<h3 id="保存配置"><a href="#保存配置" class="headerlink" title="保存配置"></a>保存配置</h3><p>终于到了这个时刻，是时候保存一下配置了。</p>
<p>比较原始的做法是输出配置到某个文件：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">err = cfg.SaveTo(<span class="string">"my.ini"</span>)</span><br><span class="line">err = cfg.SaveToIndent(<span class="string">"my.ini"</span>, <span class="string">"\t"</span>)</span><br></pre></td></tr></table></figure>
<p>另一个比较高级的做法是写入到任何实现 <code>io.Writer</code> 接口的对象中：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">cfg.WriteTo(writer)</span><br><span class="line">cfg.WriteToIndent(writer, <span class="string">"\t"</span>)</span><br></pre></td></tr></table></figure>
<p>默认情况下，空格将被用于对齐键值之间的等号以美化输出结果，以下代码可以禁用该功能：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ini.PrettyFormat = <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h2><h3 id="递归读取键值"><a href="#递归读取键值" class="headerlink" title="递归读取键值"></a>递归读取键值</h3><p>在获取所有键值的过程中，特殊语法 <code>%(&lt;name&gt;)s</code> 会被应用，其中 <code>&lt;name&gt;</code> 可以是相同分区或者默认分区下的键名。字符串 <code>%(&lt;name&gt;)s</code> 会被相应的键值所替代，如果指定的键不存在，则会用空字符串替代。您可以最多使用 99 层的递归嵌套。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">NAME</span> = ini</span><br><span class="line"></span><br><span class="line"><span class="section">[author]</span></span><br><span class="line"><span class="attr">NAME</span> = Unknwon</span><br><span class="line"><span class="attr">GITHUB</span> = https://github.com/%(NAME)s</span><br><span class="line"></span><br><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">FULL_NAME</span> = github.com/go-ini/%(NAME)s</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cfg.Section(<span class="string">"author"</span>).Key(<span class="string">"GITHUB"</span>).String()		<span class="comment">// https://github.com/Unknwon</span></span><br><span class="line">cfg.Section(<span class="string">"package"</span>).Key(<span class="string">"FULL_NAME"</span>).String()	<span class="comment">// github.com/go-ini/ini</span></span><br></pre></td></tr></table></figure>
<h3 id="读取父子分区"><a href="#读取父子分区" class="headerlink" title="读取父子分区"></a>读取父子分区</h3><p>您可以在分区名称中使用 <code>.</code> 来表示两个或多个分区之间的父子关系。如果某个键在子分区中不存在，则会去它的父分区中再次寻找，直到没有父分区为止。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">NAME</span> = ini</span><br><span class="line"><span class="attr">VERSION</span> = v1</span><br><span class="line"><span class="attr">IMPORT_PATH</span> = gopkg.in/%(NAME)s.%(VERSION)s</span><br><span class="line"></span><br><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">CLONE_URL</span> = https://%(IMPORT_PATH)s</span><br><span class="line"></span><br><span class="line"><span class="section">[package.sub]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfg.Section(<span class="string">"package.sub"</span>).Key(<span class="string">"CLONE_URL"</span>).String()	<span class="comment">// https://gopkg.in/ini.v1</span></span><br></pre></td></tr></table></figure>
<h4 id="获取上级父分区下的所有键名"><a href="#获取上级父分区下的所有键名" class="headerlink" title="获取上级父分区下的所有键名"></a>获取上级父分区下的所有键名</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfg.Section(<span class="string">"package.sub"</span>).ParentKeys() <span class="comment">// ["CLONE_URL"]</span></span><br></pre></td></tr></table></figure>
<h3 id="无法解析的分区"><a href="#无法解析的分区" class="headerlink" title="无法解析的分区"></a>无法解析的分区</h3><p>如果遇到一些比较特殊的分区，它们不包含常见的键值对，而是没有固定格式的纯文本，则可以使用 <code>LoadOptions.UnparsableSections</code> 进行处理：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cfg, err := LoadSources(ini.LoadOptions&#123;UnparseableSections: []<span class="keyword">string</span>&#123;<span class="string">"COMMENTS"</span>&#125;&#125;, <span class="string">`[COMMENTS]</span></span><br><span class="line"><span class="string">&lt;1&gt;&lt;L.Slide#2&gt; This slide has the fuel listed in the wrong units &lt;e.1&gt;`</span>))</span><br><span class="line"></span><br><span class="line">body := cfg.Section(<span class="string">"COMMENTS"</span>).Body()</span><br><span class="line"></span><br><span class="line"><span class="comment">/* --- start ---</span></span><br><span class="line"><span class="comment">&lt;1&gt;&lt;L.Slide#2&gt; This slide has the fuel listed in the wrong units &lt;e.1&gt;</span></span><br><span class="line"><span class="comment">------  end  --- */</span></span><br></pre></td></tr></table></figure>
<h3 id="读取自增键名"><a href="#读取自增键名" class="headerlink" title="读取自增键名"></a>读取自增键名</h3><p>如果数据源中的键名为 <code>-</code>，则认为该键使用了自增键名的特殊语法。计数器从 1 开始，并且分区之间是相互独立的。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[features]</span></span><br><span class="line">-: Support read/write comments of keys and sections</span><br><span class="line">-: Support auto-increment of key names</span><br><span class="line">-: Support load multiple files to overwrite key values</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfg.Section(<span class="string">"features"</span>).KeyStrings()	<span class="comment">// []&#123;"#1", "#2", "#3"&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="映射到结构"><a href="#映射到结构" class="headerlink" title="映射到结构"></a>映射到结构</h3><p>想要使用更加面向对象的方式玩转 INI 吗？好主意。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Name</span> = Unknwon</span><br><span class="line"><span class="attr">age</span> = <span class="number">21</span></span><br><span class="line"><span class="attr">Male</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">Born</span> = <span class="number">1993</span>-<span class="number">01</span>-<span class="number">01</span>T20:<span class="number">17</span>:<span class="number">05</span>Z</span><br><span class="line"></span><br><span class="line"><span class="section">[Note]</span></span><br><span class="line"><span class="attr">Content</span> = Hi is a good man!</span><br><span class="line"><span class="attr">Cities</span> = HangZhou, Boston</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Note <span class="keyword">struct</span> &#123;</span><br><span class="line">	Content <span class="keyword">string</span></span><br><span class="line">	Cities  []<span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span> <span class="string">`ini:"age"`</span></span><br><span class="line">	Male <span class="keyword">bool</span></span><br><span class="line">	Born time.Time</span><br><span class="line">	Note</span><br><span class="line">	Created time.Time <span class="string">`ini:"-"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	cfg, err := ini.Load(<span class="string">"path/to/ini"</span>)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	p := <span class="built_in">new</span>(Person)</span><br><span class="line">	err = cfg.MapTo(p)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 一切竟可以如此的简单。</span></span><br><span class="line">	err = ini.MapTo(p, <span class="string">"path/to/ini"</span>)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 嗯哼？只需要映射一个分区吗？</span></span><br><span class="line">	n := <span class="built_in">new</span>(Note)</span><br><span class="line">	err = cfg.Section(<span class="string">"Note"</span>).MapTo(n)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结构的字段怎么设置默认值呢？很简单，只要在映射之前对指定字段进行赋值就可以了。如果键未找到或者类型错误，该值不会发生改变。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">p := &amp;Person&#123;</span><br><span class="line">	Name: <span class="string">"Joe"</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>这样玩 INI 真的好酷啊！然而，如果不能还给我原来的配置文件，有什么卵用？</p>
<h3 id="从结构反射"><a href="#从结构反射" class="headerlink" title="从结构反射"></a>从结构反射</h3><p>可是，我有说不能吗？</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Embeded <span class="keyword">struct</span> &#123;</span><br><span class="line">	Dates  []time.Time <span class="string">`delim:"|" comment:"Time data"`</span></span><br><span class="line">	Places []<span class="keyword">string</span>    <span class="string">`ini:"places,omitempty"`</span></span><br><span class="line">	None   []<span class="keyword">int</span>       <span class="string">`ini:",omitempty"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Author <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name      <span class="keyword">string</span> <span class="string">`ini:"NAME"`</span></span><br><span class="line">	Male      <span class="keyword">bool</span></span><br><span class="line">	Age       <span class="keyword">int</span> <span class="string">`comment:"Author's age"`</span></span><br><span class="line">	GPA       <span class="keyword">float64</span></span><br><span class="line">	NeverMind <span class="keyword">string</span> <span class="string">`ini:"-"`</span></span><br><span class="line">	*Embeded <span class="string">`comment:"Embeded section"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := &amp;Author&#123;<span class="string">"Unknwon"</span>, <span class="literal">true</span>, <span class="number">21</span>, <span class="number">2.8</span>, <span class="string">""</span>,</span><br><span class="line">		&amp;Embeded&#123;</span><br><span class="line">			[]time.Time&#123;time.Now(), time.Now()&#125;,</span><br><span class="line">			[]<span class="keyword">string</span>&#123;<span class="string">"HangZhou"</span>, <span class="string">"Boston"</span>&#125;,</span><br><span class="line">			[]<span class="keyword">int</span>&#123;&#125;,</span><br><span class="line">		&#125;&#125;</span><br><span class="line">	cfg := ini.Empty()</span><br><span class="line">	err = ini.ReflectFrom(cfg, a)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>瞧瞧，奇迹发生了。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">NAME</span> = Unknwon</span><br><span class="line"><span class="attr">Male</span> = <span class="literal">true</span></span><br><span class="line"><span class="comment">; Author's age</span></span><br><span class="line"><span class="attr">Age</span> = <span class="number">21</span></span><br><span class="line"><span class="attr">GPA</span> = <span class="number">2.8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Embeded section</span></span><br><span class="line"><span class="section">[Embeded]</span></span><br><span class="line"><span class="comment">; Time data</span></span><br><span class="line"><span class="attr">Dates</span> = <span class="number">2015</span>-<span class="number">08</span>-<span class="number">07</span>T22:<span class="number">14</span>:<span class="number">22</span>+<span class="number">08</span>:<span class="number">00</span>|<span class="number">2015</span>-<span class="number">08</span>-<span class="number">07</span>T22:<span class="number">14</span>:<span class="number">22</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line"><span class="attr">places</span> = HangZhou,Boston</span><br></pre></td></tr></table></figure>
<h4 id="名称映射器（Name-Mapper）"><a href="#名称映射器（Name-Mapper）" class="headerlink" title="名称映射器（Name Mapper）"></a>名称映射器（Name Mapper）</h4><p>为了节省您的时间并简化代码，本库支持类型为 <a href="https://gowalker.org/gopkg.in/ini.v1#NameMapper" target="_blank" rel="noopener"><code>NameMapper</code></a> 的名称映射器，该映射器负责结构字段名与分区名和键名之间的映射。</p>
<p>目前有 2 款内置的映射器：</p>
<ul>
<li><code>AllCapsUnderscore</code>：该映射器将字段名转换至格式 <code>ALL_CAPS_UNDERSCORE</code> 后再去匹配分区名和键名。</li>
<li><code>TitleUnderscore</code>：该映射器将字段名转换至格式 <code>title_underscore</code> 后再去匹配分区名和键名。</li>
</ul>
<p>使用方法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Info <span class="keyword">struct</span>&#123;</span><br><span class="line">	PackageName <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	err = ini.MapToWithMapper(&amp;Info&#123;&#125;, ini.TitleUnderscore, []<span class="keyword">byte</span>(<span class="string">"package_name=ini"</span>))</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">	cfg, err := ini.Load([]<span class="keyword">byte</span>(<span class="string">"PACKAGE_NAME=ini"</span>))</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	info := <span class="built_in">new</span>(Info)</span><br><span class="line">	cfg.NameMapper = ini.AllCapsUnderscore</span><br><span class="line">	err = cfg.MapTo(info)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用函数 <code>ini.ReflectFromWithMapper</code> 时也可应用相同的规则。</p>
<h4 id="值映射器（Value-Mapper）"><a href="#值映射器（Value-Mapper）" class="headerlink" title="值映射器（Value Mapper）"></a>值映射器（Value Mapper）</h4><p>值映射器允许使用一个自定义函数自动展开值的具体内容，例如：运行时获取环境变量：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Env <span class="keyword">struct</span> &#123;</span><br><span class="line">	Foo <span class="keyword">string</span> <span class="string">`ini:"foo"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	cfg, err := ini.Load([]<span class="keyword">byte</span>(<span class="string">"[env]\nfoo = $&#123;MY_VAR&#125;\n"</span>)</span><br><span class="line">	cfg.ValueMapper = os.ExpandEnv</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	env := &amp;Env&#123;&#125;</span><br><span class="line">	err = cfg.Section(<span class="string">"env"</span>).MapTo(env)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本例中，<code>env.Foo</code> 将会是运行时所获取到环境变量 <code>MY_VAR</code> 的值。</p>
<h4 id="映射-反射的其它说明"><a href="#映射-反射的其它说明" class="headerlink" title="映射/反射的其它说明"></a>映射/反射的其它说明</h4><p>任何嵌入的结构都会被默认认作一个不同的分区，并且不会自动产生所谓的父子分区关联：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Child <span class="keyword">struct</span> &#123;</span><br><span class="line">	Age <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Parent <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Child</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Config <span class="keyword">struct</span> &#123;</span><br><span class="line">	City <span class="keyword">string</span></span><br><span class="line">	Parent</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>示例配置文件：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">City</span> = Boston</span><br><span class="line"></span><br><span class="line"><span class="section">[Parent]</span></span><br><span class="line"><span class="attr">Name</span> = Unknwon</span><br><span class="line"></span><br><span class="line"><span class="section">[Child]</span></span><br><span class="line"><span class="attr">Age</span> = <span class="number">21</span></span><br></pre></td></tr></table></figure>
<p>很好，但是，我就是要嵌入结构也在同一个分区。好吧，你爹是李刚！</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Child <span class="keyword">struct</span> &#123;</span><br><span class="line">	Age <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Parent <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Child <span class="string">`ini:"Parent"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Config <span class="keyword">struct</span> &#123;</span><br><span class="line">	City <span class="keyword">string</span></span><br><span class="line">	Parent</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>示例配置文件：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">City</span> = Boston</span><br><span class="line"></span><br><span class="line"><span class="section">[Parent]</span></span><br><span class="line"><span class="attr">Name</span> = Unknwon</span><br><span class="line"><span class="attr">Age</span> = <span class="number">21</span></span><br></pre></td></tr></table></figure>
<h2 id="获取帮助"><a href="#获取帮助" class="headerlink" title="获取帮助"></a>获取帮助</h2><ul>
<li><a href="https://gowalker.org/gopkg.in/ini.v1" target="_blank" rel="noopener">API 文档</a></li>
<li><a href="https://github.com/go-ini/ini/issues/new" target="_blank" rel="noopener">创建工单</a></li>
</ul>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="字段-BlockMode-是什么？"><a href="#字段-BlockMode-是什么？" class="headerlink" title="字段 BlockMode 是什么？"></a>字段 <code>BlockMode</code> 是什么？</h3><p>默认情况下，本库会在您进行读写操作时采用锁机制来确保数据时间。但在某些情况下，您非常确定只进行读操作。此时，您可以通过设置 <code>cfg.BlockMode = false</code> 来将读操作提升大约 <strong>50-70%</strong> 的性能。</p>
<h3 id="为什么要写另一个-INI-解析库？"><a href="#为什么要写另一个-INI-解析库？" class="headerlink" title="为什么要写另一个 INI 解析库？"></a>为什么要写另一个 INI 解析库？</h3><p>许多人都在使用我的 <a href="https://github.com/Unknwon/goconfig" target="_blank" rel="noopener">goconfig</a> 来完成对 INI 文件的操作，但我希望使用更加 Go 风格的代码。并且当您设置 <code>cfg.BlockMode = false</code> 时，会有大约 <strong>10-30%</strong> 的性能提升。</p>
<p>为了做出这些改变，我必须对 API 进行破坏，所以新开一个仓库是最安全的做法。除此之外，本库直接使用 <code>gopkg.in</code> 来进行版本化发布。（其实真相是导入路径更短了）</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/golang/" rel="tag"># golang</a>
          
            <a href="/tags/go/" rel="tag"># go</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/14/hello-world/" rel="next" title="Hello World">
                <i class="fa fa-chevron-left"></i> Hello World
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/05/14/Go语言使用SMTP的发送邮件报错unencrypted connection的解决方案/" rel="prev" title="Go语言使用SMTP的发送邮件报错unencrypted connection的解决方案">
                Go语言使用SMTP的发送邮件报错unencrypted connection的解决方案 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="张奇怪" />
          <p class="site-author-name" itemprop="name">张奇怪</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">41</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#功能特性"><span class="nav-number">1.</span> <span class="nav-text">功能特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下载安装"><span class="nav-number">2.</span> <span class="nav-text">下载安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#测试安装"><span class="nav-number">2.1.</span> <span class="nav-text">测试安装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#开始使用"><span class="nav-number">3.</span> <span class="nav-text">开始使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#从数据源加载"><span class="nav-number">3.1.</span> <span class="nav-text">从数据源加载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#忽略键名的大小写"><span class="nav-number">3.1.1.</span> <span class="nav-text">忽略键名的大小写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#类似-MySQL-配置中的布尔值键"><span class="nav-number">3.1.2.</span> <span class="nav-text">类似 MySQL 配置中的布尔值键</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#关于注释"><span class="nav-number">3.1.3.</span> <span class="nav-text">关于注释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#操作分区（Section）"><span class="nav-number">3.2.</span> <span class="nav-text">操作分区（Section）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#操作键（Key）"><span class="nav-number">3.3.</span> <span class="nav-text">操作键（Key）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#操作键值（Value）"><span class="nav-number">3.4.</span> <span class="nav-text">操作键值（Value）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#操作键值的辅助方法"><span class="nav-number">3.4.1.</span> <span class="nav-text">操作键值的辅助方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#自动分割键值到切片（slice）"><span class="nav-number">3.4.1.1.</span> <span class="nav-text">自动分割键值到切片（slice）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#保存配置"><span class="nav-number">3.5.</span> <span class="nav-text">保存配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高级用法"><span class="nav-number">4.</span> <span class="nav-text">高级用法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#递归读取键值"><span class="nav-number">4.1.</span> <span class="nav-text">递归读取键值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读取父子分区"><span class="nav-number">4.2.</span> <span class="nav-text">读取父子分区</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#获取上级父分区下的所有键名"><span class="nav-number">4.2.1.</span> <span class="nav-text">获取上级父分区下的所有键名</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#无法解析的分区"><span class="nav-number">4.3.</span> <span class="nav-text">无法解析的分区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读取自增键名"><span class="nav-number">4.4.</span> <span class="nav-text">读取自增键名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#映射到结构"><span class="nav-number">4.5.</span> <span class="nav-text">映射到结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#从结构反射"><span class="nav-number">4.6.</span> <span class="nav-text">从结构反射</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#名称映射器（Name-Mapper）"><span class="nav-number">4.6.1.</span> <span class="nav-text">名称映射器（Name Mapper）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#值映射器（Value-Mapper）"><span class="nav-number">4.6.2.</span> <span class="nav-text">值映射器（Value Mapper）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#映射-反射的其它说明"><span class="nav-number">4.6.3.</span> <span class="nav-text">映射/反射的其它说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取帮助"><span class="nav-number">5.</span> <span class="nav-text">获取帮助</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常见问题"><span class="nav-number">6.</span> <span class="nav-text">常见问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#字段-BlockMode-是什么？"><span class="nav-number">6.1.</span> <span class="nav-text">字段 BlockMode 是什么？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么要写另一个-INI-解析库？"><span class="nav-number">6.2.</span> <span class="nav-text">为什么要写另一个 INI 解析库？</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张奇怪</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
